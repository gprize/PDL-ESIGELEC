CREATE TABLE GESTIONNAIRES_PRINCIPAUX(
id_gestprincip INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 100000 INCREMENT BY 1) ,
mot_de_passe VARCHAR2(20) NOT NULL,
nom VARCHAR(40),
prenom VARCHAR(40),
PRIMARY KEY (id_gestprincip)
);
INSERT INTO gestionnaires_principaux(mot_de_passe,nom,prenom) 
VALUES ('XSXCSC','DELAGARDE' ,'Jean');

CREATE TABLE GESTIONNAIRES_ADMINISTRATIFS(
id_gestadmin INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 200000 INCREMENT BY 1) ,
mot_de_passe VARCHAR2(20) NOT NULL,
nom VARCHAR(40),
prenom VARCHAR(40),
PRIMARY KEY (id_gestadmin)
);
INSERT INTO gestionnaires_administratifs(mot_de_passe,nom,prenom) 
VALUES ('YU23CSS','DESLANDES' ,'Christophe');
INSERT INTO gestionnaires_administratifs(mot_de_passe,nom,prenom) 
VALUES ('fdjvnfn22','AZZEDINE' ,'Ilona');

CREATE TABLE ENSEIGNANTS (
id_enseignant INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 300000 INCREMENT BY 1) ,
mot_de_passe VARCHAR2(20) NOT NULL,
nom VARCHAR(40),
prenom VARCHAR(40),
numtel INTEGER,
PRIMARY KEY (id_enseignant)
);
INSERT INTO ENSEIGNANTS(mot_de_passe,nom,prenom,numtel)
VALUES ('2SXQ233','OUNAHI','Estelle','0787560212');
INSERT INTO ENSEIGNANTS(mot_de_passe,nom,prenom,numtel)
VALUES ('XS3D4XZ2','NIAMIEN','Jean','0609339292');
INSERT INTO ENSEIGNANTS(mot_de_passe,nom,prenom,numtel)
VALUES ('XS3D4DV','DEMONCEAU','Louis','0782332123');

CREATE TABLE GROUPES(
id_groupe INTEGER,
taille_max INTEGER CHECK(taille_max>0),
PRIMARY KEY (id_groupe)
);
INSERT INTO GROUPES 
VALUES (1,30);
INSERT INTO GROUPES 
VALUES (2,30);
INSERT INTO GROUPES 
VALUES (3,33);
INSERT INTO GROUPES 
VALUES (4,33);
INSERT INTO GROUPES 
VALUES (5,31);

CREATE TABLE ELEVES(
id_eleve INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 400000 INCREMENT BY 1) ,
id_groupe INTEGER, 
mot_de_passe VARCHAR2(20) NOT NULL,
nom VARCHAR(40),
prenom VARCHAR(40),
numtel INTEGER,
filiere VARCHAR(40) NOT NULL CHECK( filiere IN('APPRENTISSAGE','CLASSIQUE')),
FOREIGN KEY (id_groupe) REFERENCES GROUPES(id_groupe),
PRIMARY KEY (id_eleve)
);
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (1,'XS3D4DV','NGOM PRISO','William','0604802321','APPRENTISSAGE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (3,'2S25FVD','KENFACK','Gabrisson','0622335256','APPRENTISSAGE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (2,'02NDY6','AZEUFACK','Hypolite','066432321','CLASSIQUE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (3,'BHY24FVDS','ALEXIA','Orelle','0798822330','CLASSIQUE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (3,'NDEZYBD53BDN','ACHRAF','Hakimi','0743565489','CLASSIQUE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (3,'JNXE53N','Yvy','Yvette','0709346521','CLASSIQUE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (3,'BDEBF53HN','Ngonsouma','Simplice','0698786754','CLASSIQUE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (3,'2SXQ233','Mebong','Ernest','0787560212','CLASSIQUE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (1,'XS3D4XZ2','LAUBERGE','Pierrot','0609339292','CLASSIQUE');
INSERT INTO ELEVES(id_groupe,mot_de_passe,nom,prenom,numtel,filiere)
VALUES (1,'XS3D4DV','VALENTIN','Joffre','0782332123','CLASSIQUE');

CREATE TABLE ASSOCIATIONS_ENSEIGNANTS_COURS (
id_enseignant INTEGER,
id_cours INTEGER,
FOREIGN KEY (id_enseignant) REFERENCES ENSEIGNANTS(id_enseignant),
FOREIGN KEY (id_cours) REFERENCES COURS(id_cours),
PRIMARY KEY (id_enseignant,id_cours)
);

CREATE TABLE COURS(
id_cours INTEGER,
nom VARCHAR(40),
masse_horaire_amphi INTEGER,
masse_horaire_td INTEGER,
masse_horaire_tp INTEGER,
masse_horaire_exam INTEGER,
PRIMARY KEY (id_cours)
);

CREATE TABLE SALLES(
id_salle INTEGER,
nom VARCHAR(20),
PRIMARY KEY (id_salle)
);

CREATE TABLE HORAIRES(
id_horaire INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1),
heure_de_debut INTEGER,
minute_de_debut INTEGER,
heure_de_fin INTEGER,
minute_de_fin INTEGER,
id_salle INTEGER,
date_horaire DATE,
id_cours INTEGER,
id_enseignant INTEGER,
id_groupe INTEGER,
est_annulee INTEGER DEFAULT 0,
CHECK (est_annulee=0 OR est_annulee=1),
FOREIGN KEY (id_salle) REFERENCES SALLES(id_salle),
FOREIGN KEY (id_cours) REFERENCES COURS(id_cours),
FOREIGN KEY (id_enseignant) REFERENCES ENSEIGNANTS(id_enseignant),
FOREIGN KEY (id_groupe) REFERENCES GROUPES(id_groupe),
PRIMARY KEY (heure_de_debut, minute_de_debut,heure_de_fin, minute_de_fin, id_salle, date_horaire)
);
ALTER TABLE HORAIRES
add UNIQUE (id_horaire);

CREATE TABLE TYPES_ABSENCES (
id_type_absence INTEGER,
quota_absence INTEGER,
designation VARCHAR(40),
PRIMARY KEY (id_type_absence)
);

CREATE TABLE ABSENCES_ENSEIGNANTS (
id_horaire INTEGER,
id_enseignant INTEGER,
id_type_absence INTEGER,
est_hors_quota INTEGER DEFAULT 0,
CHECK (est_hors_quota=0 OR est_hors_quota=1),
FOREIGN KEY (id_horaire) REFERENCES HORAIRES(id_horaire),
FOREIGN KEY (id_enseignant) REFERENCES ENSEIGNANTS(id_enseignant),
FOREIGN KEY (id_type_absence) REFERENCES TYPES_ABSENCES(id_type_absence),
PRIMARY KEY (id_horaire, id_enseignant)
);


  CREATE TABLE "C##BDD6_20"."JUSTIFICATIFS_DISTANCIELS" 
   (	"ID_JUSTIF_DIST" INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1), 
	"EST_VALIDEE" VARCHAR2(30 BYTE), 
	"MOTIF" VARCHAR2(40 BYTE), 
	"ID_HORAIRE" NUMBER(*,0), 
	 CHECK (est_validee='EN COURS DE TRAITEMENT' OR est_validee='OUI' OR est_validee='NON') ENABLE, 
	 PRIMARY KEY ("ID_JUSTIF_DIST")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
  

  CREATE TABLE "C##BDD6_20"."ABSENCES_DISTANCIELS_ELEVES" 
   (	"ID_HORAIRE" NUMBER(*,0), 
	"ID_ELEVE" NUMBER(*,0), 
	"ID_TYPE_ABSENCE" NUMBER(*,0), 
	"ID_JUSTIF_DIST" NUMBER(*,0) NOT NULL ENABLE, 
	"EST_HORS_QUOTA" NUMBER(*,0) DEFAULT 0, 
	 CHECK (est_hors_quota=0 OR est_hors_quota=1) ENABLE, 
	 CONSTRAINT "SYS_C00384721" PRIMARY KEY ("ID_HORAIRE", "ID_ELEVE", "ID_JUSTIF_DIST")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  TABLESPACE "USERS"  ENABLE, 
	 FOREIGN KEY ("ID_HORAIRE")
	  REFERENCES "C##BDD6_20"."HORAIRES" ("ID_HORAIRE") ENABLE, 
	 FOREIGN KEY ("ID_ELEVE")
	  REFERENCES "C##BDD6_20"."ELEVES" ("ID_ELEVE") ENABLE, 
	 FOREIGN KEY ("ID_TYPE_ABSENCE")
	  REFERENCES "C##BDD6_20"."TYPES_ABSENCES" ("ID_TYPE_ABSENCE") ENABLE, 
	 CONSTRAINT "SYS_C00384725" FOREIGN KEY ("ID_JUSTIF_DIST")
	  REFERENCES "C##BDD6_20"."JUSTIFICATIFS_DISTANCIELS" ("ID_JUSTIF_DIST") ON DELETE CASCADE DISABLE
   ) SEGMENT CREATION DEFERRED 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  TABLESPACE "USERS" ;